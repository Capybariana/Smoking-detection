# Smoking-detection

## Описание проекта

Этот проект предназначен для обработки видео с использованием машинного обучения для обнаружения жестов курения. Проект позволяет обрабатывать видеофайлы, накладывать bounding boxes на обнаруженные объекты и сохранять результат в новый видеофайл.

## Проблематика

 В данном проекте решается задача обнаружения сигарет в видео, что может быть полезно для контроля за соблюдением правил в общественных местах или для анализа поведения.

## Общее решение

Для решения задачи используется связка openpifpaf и свмодельной модели, которая была обучена на датасете. Видео обрабатывается по кадрам, на каждом кадре модель предсказывает наличие объектов и рисует bounding boxes вокруг них. Результат сохраняется в новый видеофайл.

## Используемый датасет

Использован личный датасет с камер НГУ

## Установка

Для запуска проекта необходимо установить следующие зависимости:

```bash
pip install -r requirements.txt
```
## Запуск

- Убедитесь, что все зависимости установлены.
- Склонируйте репозиторий (если необходимо) и перейдите в директорию проекта.
- Запустите скрипт обработки видео, указав пути к входному и выходному видеофайлам.

Пример команды для запуска:
 ```
python3 SmokingDetector.py --video=input.mp4 --json=input.json --output=ouput.mp4 --model=path/to/weights.pth

```
Где:

input.mp4 — путь к входному видеофайлу.

input.json — путь к входному JSON файлу с ключевыми точками людей в кадре. 

output.mp4 — путь для сохранения выходного видеофайла.

path/to/weights.pth - путь к весам обученной модели.

## Пример работы

Можете посмотреть в examples

 ## Доработки

- Улучшение модели: Можно дообучить модель на более разнообразном датасете для повышения точности обнаружения.

- Добавление функционала: Можно добавить возможность обработки потокового видео с камеры в реальном времени.
